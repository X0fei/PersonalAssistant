<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="500"
        x:Class="PersonalAssistant.TasksWindow"
		x:CompileBindings="False"
		WindowStartupLocation="CenterScreen"
		Width="600" Height="500"
        Title="Задачи" >
	
	<DockPanel
		Margin="10">

		<!-- Панель меню -->
		<Grid
			ColumnDefinitions="Auto, *, Auto"
			DockPanel.Dock="Top">

			<!-- Кнопка «Выйти» -->
			<Button
				Grid.Column="0"
				Name="GoBackButton"
				Content="Выйти"
				Click="GoBackButton_Click"/>

			<!-- Панель с кнопками для перехода на другие окна -->
			<StackPanel
				Grid.Column="1"
				Orientation="Horizontal"
				HorizontalAlignment="Center"
				Spacing="10">

				<!-- Кнопка «Матрица Эйзенхауэра» -->
				<Button
					Name="MatrixButton"
					Content="Матрица Эйзенхауэра"
					Click="MatrixButton_Click"/>
				
				<!-- Кнопка «Настроение» -->
				<Button
					Name="MoodButton"
					Content="Настроение"
					Click="MoodButton_Click"/>

				<!-- Кнопка «Статистика» -->
				<Button
					Name="StatisticsButton"
					Content="Статистика"/>
				
			</StackPanel>

			<!-- Кнопка для перехода в профиль пользователя -->
			<Button
				Grid.Column="2"
				Name="ProfileButton"
				Content="Имя"
				Click="ProfileButton_Click"/>
			
		</Grid>

		<DockPanel
			Margin="0, 30, 0, 0">

			<Grid
				ColumnDefinitions="Auto, *"
				DockPanel.Dock="Top">

				<!-- Панель с фильтром -->
				<StackPanel
					Grid.Column="0"
					Orientation="Horizontal">
					
					<TextBlock
						Text="Фильтр:"
						VerticalAlignment="Center"
						Margin="0,0,5,0"/>
					<ComboBox
						Name="FilterComboBox"
						SelectionChanged="FilterComboBox_SelectionChanged"
						Width="150"/>
					
				</StackPanel>

				<StackPanel
					Grid.Column="1"
					Orientation="Horizontal"
					HorizontalAlignment="Right"
					Spacing="10">

					<Button
						Name="AddListOfTasksButton"
						Content="Добавить список"
						Click="AddListOfTasksButton_Click"/>
					<Button
						Name="AddTaskButton"
						Content="Добавить задачу"
						Click="AddTaskButton_Click"/>
					
				</StackPanel>
				
			</Grid>
			
			<ScrollViewer>
				
				<Grid
					RowDefinitions="Auto, *, *"
					Margin="0 10 0 0">

					<ListBox
						Grid.Row="0"
						Name="ListsOfTasks"
						SelectionChanged="ListsOfTasks_SelectionChanged"
						DoubleTapped="ListsOfTasks_ItemDoubleTapped"
						SelectionMode="Single"
						ScrollViewer.HorizontalScrollBarVisibility="Hidden"
						PointerWheelChanged="HorizontalScrollViewerWithoutShift"
						BorderThickness="1">
						<ListBox.ItemsPanel>
							<ItemsPanelTemplate>
								<StackPanel
									Orientation="Horizontal"/>
							</ItemsPanelTemplate>
						</ListBox.ItemsPanel>
						<ListBox.ItemTemplate>
							<DataTemplate>
								<TextBlock
										Text="{Binding Name}"/>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>

					<ListBox
						Grid.Row="1"
						Name="AllTasksList"
						DoubleTapped="Item_DoubleTapped"
						BorderThickness="1"
						MaxHeight="300">
						<ListBox.ItemTemplate>
							<DataTemplate>
								<Border
									Tag="{Binding Id}"
									Background="">
									<StackPanel>
										<TextBlock
											Text="{Binding Name}"/>
										<TextBlock
											Text="{Binding Description}"/>
										<TextBlock >
											<Run  Text="Приоритет:"/>
											<Run Text="{Binding PriorityNavigation.Name}"/>
										</TextBlock>
										<TextBlock
											Text="{Binding StatusNavigation.Name}"/>
									</StackPanel>
								</Border>
							</DataTemplate>
						</ListBox.ItemTemplate>
					</ListBox>

					<Grid
						Grid.Row="2"
						Margin="0, 20, 0, 0"
						RowDefinitions="Auto, *">

						<!-- Календарь -->
						<Calendar
							Name="TasksCalendar"
							SelectedDatesChanged="TasksCalendar_SelectedDatesChanged"
							PointerExited="TasksCalendar_PointerExited"
							Margin="0, 0, 0, 10"/>

						<!-- Всплывающее окно с задачами на выбранную дату -->
						<Popup
							Name="TasksOnDatePopup"
							Placement="BottomEdgeAlignedRight"
							IsOpen="{Binding IsPopupOpen}">
							<Border
								Background="White"
								BorderBrush="Gray"
								BorderThickness="1"
								Padding="8">
								<StackPanel>
									<TextBlock
										Text="Задачи на этот день:"
										FontWeight="Bold"
										Margin="0,0,0,5"/>
									<ListBox
										Name="TasksOnDateList"
										DoubleTapped="Item_DoubleTapped"
										BorderThickness="1">
										<ListBox.ItemTemplate>
											<DataTemplate>
												<Border
													Tag="{Binding Id}"
													Background="">
													<StackPanel>
														<TextBlock
															Text="{Binding Name}"/>
														<TextBlock
															Text="{Binding Description}"/>
														<TextBlock >
															<Run  Text="Приоритет:"/>
															<Run Text="{Binding PriorityNavigation.Name}"/>
														</TextBlock>
														<TextBlock
															Text="{Binding StatusNavigation.Name}"/>
													</StackPanel>
												</Border>
											</DataTemplate>
										</ListBox.ItemTemplate>
									</ListBox>
								</StackPanel>
							</Border>
						</Popup>
					</Grid>

				</Grid>

			</ScrollViewer>

		</DockPanel>

	</DockPanel>
	
</Window>
